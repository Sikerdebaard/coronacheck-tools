.DEFAULT_GOAL := build 
SHELL:=/bin/bash

all: build

clean:
	rm -rf ./lib/*.dll
	rm -rf ./lib/*.so
	rm -rf ./lib/*.h

pibuild:
	cd src
	make
	cd ..
	mv src/dist/* lib/


build: 
	## AUTOGENERATED ##

	docker run -it --rm -v $$PWD/src:/go/src/github.com/user/go-project -w /go/src/github.com/user/go-project -e CGO_ENABLED=1 -e CHOWNPERMS=`id -u`:`id -g` -e OUTFILE=dist/verifier-linux-amd64.so docker.elastic.co/beats-dev/golang-crossbuild:1.16.4-main --build-cmd "make build" -p "linux/amd64"
	docker run -it --rm -v $$PWD/src:/go/src/github.com/user/go-project -w /go/src/github.com/user/go-project -e CGO_ENABLED=1 -e CHOWNPERMS=`id -u`:`id -g` -e OUTFILE=dist/verifier-linux-386.so docker.elastic.co/beats-dev/golang-crossbuild:1.16.4-main --build-cmd "make build" -p "linux/386"
	docker run -it --rm -v $$PWD/src:/go/src/github.com/user/go-project -w /go/src/github.com/user/go-project -e CGO_ENABLED=1 -e CHOWNPERMS=`id -u`:`id -g` -e OUTFILE=dist/verifier-windows-amd64.dll docker.elastic.co/beats-dev/golang-crossbuild:1.16.4-main --build-cmd "make build" -p "windows/amd64"
	docker run -it --rm -v $$PWD/src:/go/src/github.com/user/go-project -w /go/src/github.com/user/go-project -e CGO_ENABLED=1 -e CHOWNPERMS=`id -u`:`id -g` -e OUTFILE=dist/verifier-windows-386.dll docker.elastic.co/beats-dev/golang-crossbuild:1.16.4-main --build-cmd "make build" -p "windows/386"
	docker run -it --rm -v $$PWD/src:/go/src/github.com/user/go-project -w /go/src/github.com/user/go-project -e CGO_ENABLED=1 -e CHOWNPERMS=`id -u`:`id -g` -e OUTFILE=dist/verifier-linux-arm64.so docker.elastic.co/beats-dev/golang-crossbuild:1.16.4-arm --build-cmd "make build" -p "linux/arm64"
	docker run -it --rm -v $$PWD/src:/go/src/github.com/user/go-project -w /go/src/github.com/user/go-project -e CGO_ENABLED=1 -e CHOWNPERMS=`id -u`:`id -g` -e OUTFILE=dist/verifier-linux-armv5.so docker.elastic.co/beats-dev/golang-crossbuild:1.16.4-armel --build-cmd "make build" -p "linux/armv5"
	docker run -it --rm -v $$PWD/src:/go/src/github.com/user/go-project -w /go/src/github.com/user/go-project -e CGO_ENABLED=1 -e CHOWNPERMS=`id -u`:`id -g` -e OUTFILE=dist/verifier-linux-armv6.so docker.elastic.co/beats-dev/golang-crossbuild:1.16.4-armel --build-cmd "make build" -p "linux/armv6"
	docker run -it --rm -v $$PWD/src:/go/src/github.com/user/go-project -w /go/src/github.com/user/go-project -e CGO_ENABLED=1 -e CHOWNPERMS=`id -u`:`id -g` -e OUTFILE=dist/verifier-linux-armv7.so docker.elastic.co/beats-dev/golang-crossbuild:1.16.4-armhf --build-cmd "make build" -p "linux/armv7"
	docker run -it --rm -v $$PWD/src:/go/src/github.com/user/go-project -w /go/src/github.com/user/go-project -e CGO_ENABLED=1 -e CHOWNPERMS=`id -u`:`id -g` -e OUTFILE=dist/verifier-darwin-amd64.so docker.elastic.co/beats-dev/golang-crossbuild:1.16.4-darwin-debian10 --build-cmd "make build" -p "darwin/amd64"
	docker run -it --rm -v $$PWD/src:/go/src/github.com/user/go-project -w /go/src/github.com/user/go-project -e CGO_ENABLED=1 -e CHOWNPERMS=`id -u`:`id -g` -e OUTFILE=dist/verifier-linux-ppc64le.so docker.elastic.co/beats-dev/golang-crossbuild:1.16.4-ppc --build-cmd "make build" -p "linux/ppc64le"

	## / AUTOGENERATED ##

	mv src/dist/* lib/
	rm -rf src/dist
